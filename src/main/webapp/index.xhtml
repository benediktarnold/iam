<?xml version="1.0" encoding="UTF-8"?>

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.prime.com.tr/ui">
<f:view>
	<h:head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>PrimeFaces Test</title>
	</h:head>
	<body>
	<h:messages />
	<h:form>
		<p:commandLink action="#{pageController.newPage()}" update=":tabPanel">Neue Seite</p:commandLink>
	</h:form>

	<p:tabView id="tabPanel" binding="#{pageController.tabView}">

		<p:tab title="View">
			<h1><h:outputText value="#{pageController.current.title}" /></h1>
			<p><h:outputText value="#{pageController.current.content}"
				escape="false" converter="brConverter" /></p>
		</p:tab>

		<p:tab title="Edit" rendered="#{!pageController.historic}">
			<h:form id="editForm">
				<h:panelGrid columns="1" width="100%">
					<h:inputText value="#{pageController.current.title}"
						style="width: 100%" />
					<h:inputTextarea value="#{pageController.current.content}"
						style="width: 100%" rows="20" />
					<p:commandButton label="Update" action="#{pageController.save()}"
						update=":tabPanel">
						<f:param name="id" value="#{param['id']}" />
					</p:commandButton>
				</h:panelGrid>
			</h:form>
		</p:tab>

		<p:tab title="Änderungen" rendered="#{!pageController.historic}">
			<h:form>
				<h:dataTable var="rev" value="#{pageController.revisions}">
					<h:column>
						<f:facet name="header">
							<h:outputText value="Revision" />
						</f:facet>
						<h:outputLink value="index.jsf">#{rev[1].id}
							<f:param name="id" value="#{rev[0].id}" />
							<f:param name="rev" value="#{rev[1].id}" />
						</h:outputLink>

					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Titel" />
						</f:facet>
						<h:outputText value="#{rev[0].title}" />
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Datum" />
						</f:facet>
						<h:outputText value="#{rev[1].revisionDate}">
							<f:convertDateTime type="both" />
						</h:outputText>
					</h:column>
					<h:column>
						<f:facet name="header">
							<h:outputText value="Änderung" />
						</f:facet>
						<h:outputText value="#{rev[2]}" />
					</h:column>
				</h:dataTable>
			</h:form>
		</p:tab>
	</p:tabView>

	</body>
</f:view>
</html>

